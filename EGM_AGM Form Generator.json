{"files":[{"id":"c7b6dd6a-4056-4243-9d40-8bd381b85d22","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"Europe/Dublin\",\n  \"dependencies\": {},\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\",\n  \"webapp\": {\n    \"executeAs\": \"USER_ACCESSING\",\n    \"access\": \"DOMAIN\"\n  }\n}"},{"id":"b73fec4d-da7f-41b0-9b70-7401ccd8046e","name":"Code","type":"server_js","source":"// \u003d\u003d\u003d Entry point for the Web App \u003d\u003d\u003d\nfunction doGet() {\n  return HtmlService.createHtmlOutputFromFile(\u0027FormInput\u0027)\n    .setTitle(\"Form Generator\");\n}\n\n// \u003d\u003d\u003d Check if a folder exists by name \u003d\u003d\u003d\nfunction checkFolderExists(folderName) {\n  const folders \u003d DriveApp.getFoldersByName(folderName);\n  return folders.hasNext();\n}\n\n// \u003d\u003d\u003d Generate the forms from a template \u003d\u003d\u003d\nfunction generateForms(data) {\n  // \u003d\u003d\u003d Validate all fields are filled \u003d\u003d\u003d\n  if (!data.roles || !data.society || !data.type || !data.year || !data.folder) {\n    throw new Error(\"All fields must be filled before generating forms.\");\n  }\n\n  const roles \u003d data.roles.split(\u0027,\u0027).map(r \u003d\u003e r.trim()).filter(r \u003d\u003e r);\n  const society \u003d data.society.trim();\n  const type \u003d data.type.trim();\n  const year \u003d data.year.trim();\n  const parentFolderName \u003d data.folder.trim();\n\n  const folders \u003d DriveApp.getFoldersByName(parentFolderName);\n  if (!folders.hasNext()) return false; // Folder doesn\u0027t exist\n\n  const parentFolder \u003d folders.next();\n\n  // Create or find subfolder with society name\n  let societyFolder;\n  const subfolders \u003d parentFolder.getFoldersByName(society);\n  societyFolder \u003d subfolders.hasNext() ? subfolders.next() : parentFolder.createFolder(society);\n\n  // \u003d\u003d\u003d Use provided Form Template File ID \u003d\u003d\u003d\n  const TEMPLATE_ID \u003d \"1D6tl21TE05GTgcco0IAw9XucR7Z61EIVHGx7gFt5ABs\";\n\n  try {\n    roles.forEach(role \u003d\u003e {\n      const formTitle \u003d `${role} ${society} ${type} ${year}`;\n\n      // Make a copy of the template form\n      const templateFile \u003d DriveApp.getFileById(TEMPLATE_ID);\n      const copiedFile \u003d templateFile.makeCopy(formTitle, societyFolder);\n      const form \u003d FormApp.openById(copiedFile.getId());\n\n      // Update title and questions (if needed)\n      form.setTitle(formTitle);\n\n      // Optionally: remove or update placeholder question\n      const items \u003d form.getItems(FormApp.ItemType.MULTIPLE_CHOICE);\n      if (items.length \u003e 0) {\n        const mcItem \u003d items[0].asMultipleChoiceItem();\n        mcItem.setTitle(`${role} Election`);\n        mcItem.setChoiceValues([\n          \u0027Candidate 1\u0027, \u0027Candidate 2\u0027, \u0027Candidate 3\u0027, \u0027Candidate 4\u0027, \u0027R.O.N\u0027\n        ]);\n      }\n    });\n\n    return true;\n  } catch (e) {\n    Logger.log(\"Error generating forms: \" + e);\n    return false;\n  }\n}\n"},{"id":"5e0c0f3f-fee1-42dc-bc86-a807b70d6826","name":"FormInput","type":"html","source":"\u003c!DOCTYPE html\u003e\n\u003chtml lang\u003d\"en\"\u003e\n\u003chead\u003e\n  \u003ctitle\u003eUCC Election Form Generator\u003c/title\u003e\n  \u003cmeta charset\u003d\"UTF-8\"\u003e\n  \u003cmeta name\u003d\"viewport\" content\u003d\"width\u003ddevice-width, initial-scale\u003d1\"\u003e\n  \u003clink rel\u003d\"stylesheet\" href\u003d\"https://www.w3schools.com/w3css/5/w3.css\"\u003e\n  \u003clink rel\u003d\"stylesheet\" href\u003d\"https://fonts.googleapis.com/css2?family\u003dLexend\u0026display\u003dswap\"\u003e\n  \u003cstyle\u003e\n    body, h1, h2, h3, h4, h5 {\n      font-family: \u0027Lexend\u0027, sans-serif;\n    }\n    body {\n      font-size: 16px;\n      background: url(\u0027https://drive.google.com/uc?id\u003d17ffu4xxqmd7Wfxdk0MqQFge8PC00MxQ7\u0026export\u003ddownload\u0027) no-repeat center center fixed;\n      background-size: cover;\n      margin: 0;\n    }\n    .overlay {\n      background-color: rgba(255, 255, 255, 0.75);\n      position: fixed;\n      top: 0;\n      left: 60px;\n      width: calc(100% - 60px);\n      height: 100vh;\n      padding: 40px;\n      overflow-y: auto;\n      transition: left 0.3s ease, width 0.3s ease;\n    }\n    #sideMenu.expanded ~ .overlay {\n      left: 16.66%;\n      width: calc(100% - 16.66%);\n    }\n    .toast {\n      visibility: hidden;\n      min-width: 250px;\n      margin-left: -125px;\n      background-color: #333;\n      color: #fff;\n      text-align: center;\n      border-radius: 8px;\n      padding: 16px;\n      position: fixed;\n      z-index: 100;\n      left: 50%;\n      bottom: 30px;\n      font-size: 17px;\n      opacity: 0;\n      transition: opacity 0.5s ease-in-out, visibility 0s linear 0.5s;\n    }\n    .toast.show {\n      visibility: visible;\n      opacity: 1;\n      transition-delay: 0s;\n    }\n    #sideMenu {\n      height: 100%;\n      width: 60px;\n      position: fixed;\n      z-index: 10;\n      top: 0;\n      left: 0;\n      background-color: #7566a0;\n      overflow-x: hidden;\n      transition: 0.3s;\n      padding-top: 60px;\n    }\n    #sideMenu.expanded {\n      width: 16.66%;\n    }\n    #sideMenu a {\n      padding: 16px 15px;\n      text-decoration: none;\n      font-size: 18px;\n      color: white;\n      display: block;\n      transition: 0.3s;\n    }\n    #sideMenu a + a {\n      margin-top: 12px;\n    }\n    #sideMenu a.active {\n      background-color: rgba(255, 255, 255, 0.2);\n      font-weight: bold;\n    }\n    #sideMenu .closebtn {\n      position: absolute;\n      top: 0;\n      left: 0;\n      padding: 15px;\n      cursor: pointer;\n    }\n    #menuIcon {\n      font-size: 30px;\n      color: white;\n    }\n    .custom-color {\n      background-color: #7566a0 !important;\n      color: white !important;\n    }\n    .w3-text-custom {\n      color: #7566a0 !important;\n    }\n  \u003c/style\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\n\u003c!-- Toast Message --\u003e\n\u003cdiv id\u003d\"toast\" class\u003d\"toast\"\u003e\u003c/div\u003e\n\n\u003c!-- Side Menu --\u003e\n\u003cdiv id\u003d\"sideMenu\"\u003e\n  \u003cdiv class\u003d\"closebtn\" onclick\u003d\"toggleMenu()\"\u003e\n    \u003cspan id\u003d\"menuIcon\"\u003e☰\u003c/span\u003e\n  \u003c/div\u003e\n  \u003cdiv id\u003d\"menuItems\" style\u003d\"display:none;\"\u003e\n    \u003ca href\u003d\"#\" class\u003d\"active\"\u003eHome\u003c/a\u003e\n    \u003ca href\u003d\"#\"\u003eForm Generator\u003c/a\u003e\n    \u003ca href\u003d\"https://represent.org.au/count/\" target\u003d\"_blank\"\u003ePR-STV Counter\u003c/a\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n\n\u003c!-- Main Content --\u003e\n\u003cdiv class\u003d\"overlay\" id\u003d\"mainContent\"\u003e\n  \u003cdiv class\u003d\"w3-container\"\u003e\n    \u003ch2 class\u003d\"w3-text-custom\"\u003e\n      \u003cimg src\u003d\"https://drive.google.com/thumbnail?id\u003d1ckLr2XDjP03qD3xBrrwfirsoChUgH5pC\" alt\u003d\"UCC Societies Logo\" style\u003d\"height:100px; vertical-align:middle; margin-right:10px;\"\u003e\n      UCC Societies Election Form Generator\n    \u003c/h2\u003e\n    \u003chr style\u003d\"width:50px;border:5px solid #7566a0\" class\u003d\"w3-round\"\u003e\n\n    \u003c!-- Step 1 --\u003e\n    \u003cdiv id\u003d\"step1\"\u003e\n      \u003clabel class\u003d\"w3-text-grey\"\u003eEnter Main Folder Name (e.g., AGM 24/25):\u003c/label\u003e\n      \u003cinput class\u003d\"w3-input w3-border\" type\u003d\"text\" id\u003d\"folder\" placeholder\u003d\"AGM 24/25\"\u003e\n      \u003cbr\u003e\n      \u003cbutton class\u003d\"w3-button custom-color\" onclick\u003d\"checkFolder()\"\u003eNext\u003c/button\u003e\n      \u003cp id\u003d\"folder-status\" class\u003d\"w3-text-red\"\u003e\u003c/p\u003e\n    \u003c/div\u003e\n\n    \u003c!-- Step 2 --\u003e\n    \u003cdiv id\u003d\"step2\" style\u003d\"display:none;\"\u003e\n      \u003clabel class\u003d\"w3-text-grey\"\u003eSociety Name:\u003c/label\u003e\n      \u003cinput class\u003d\"w3-input w3-border\" type\u003d\"text\" id\u003d\"society\" placeholder\u003d\"EngSoc\"\u003e\n      \u003cbr\u003e\n      \u003clabel class\u003d\"w3-text-grey\"\u003eSelect Type:\u003c/label\u003e\u003cbr\u003e\n      \u003cbutton class\u003d\"w3-button w3-light-grey\" id\u003d\"btn-agm\" onclick\u003d\"selectType(this, \u0027AGM\u0027)\"\u003eAGM\u003c/button\u003e\n      \u003cbutton class\u003d\"w3-button w3-light-grey\" id\u003d\"btn-egm\" onclick\u003d\"selectType(this, \u0027EGM\u0027)\"\u003eEGM\u003c/button\u003e\n      \u003cinput type\u003d\"hidden\" id\u003d\"type\"\u003e\n      \u003cbr\u003e\u003cbr\u003e\n      \u003clabel class\u003d\"w3-text-grey\"\u003eSelect Year:\u003c/label\u003e\n      \u003cselect class\u003d\"w3-select w3-border\" id\u003d\"year\"\u003e\u003c/select\u003e\n      \u003cbr\u003e\u003cbr\u003e\n      \u003clabel class\u003d\"w3-text-grey\"\u003eEnter Roles (comma-separated):\u003c/label\u003e\n      \u003cinput class\u003d\"w3-input w3-border\" type\u003d\"text\" id\u003d\"roles\" placeholder\u003d\"PRO, Treasurer, Chair\"\u003e\n      \u003cbr\u003e\n      \u003cbutton class\u003d\"w3-button w3-light-grey\" onclick\u003d\"showStep(1)\"\u003eBack\u003c/button\u003e\n      \u003cbutton class\u003d\"w3-button custom-color\" onclick\u003d\"confirmSubmission()\"\u003eGenerate Forms\u003c/button\u003e\n      \u003cp id\u003d\"generate-status\" class\u003d\"w3-text-green\"\u003e\u003c/p\u003e\n    \u003c/div\u003e\n\n    \u003c!-- Step 3 --\u003e\n    \u003cdiv id\u003d\"step3\" style\u003d\"display:none;\" class\u003d\"w3-center\"\u003e\n      \u003cimg id\u003d\"result-img\" style\u003d\"max-width:300px\"\u003e\n      \u003ch3 id\u003d\"result-msg\"\u003e\u003c/h3\u003e\n      \u003cbutton class\u003d\"w3-button custom-color\" onclick\u003d\"showStep(1)\"\u003eStart Over\u003c/button\u003e\n    \u003c/div\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n\n\u003cscript\u003e\n  function toggleMenu() {\n    const menu \u003d document.getElementById(\"sideMenu\");\n    const icon \u003d document.getElementById(\"menuIcon\");\n    const overlay \u003d document.getElementById(\"mainContent\");\n    const items \u003d document.getElementById(\"menuItems\");\n\n    if (menu.classList.contains(\"expanded\")) {\n      menu.classList.remove(\"expanded\");\n      icon.innerHTML \u003d \"☰\";\n      items.style.display \u003d \"none\";\n      overlay.style.left \u003d \"60px\";\n      overlay.style.width \u003d \"calc(100% - 60px)\";\n    } else {\n      menu.classList.add(\"expanded\");\n      icon.innerHTML \u003d \"✖\";\n      items.style.display \u003d \"block\";\n      overlay.style.left \u003d \"16.66%\";\n      overlay.style.width \u003d \"calc(100% - 16.66%)\";\n    }\n  }\n\n  function showToast(message, duration \u003d 3000) {\n    const toast \u003d document.getElementById(\"toast\");\n    toast.innerText \u003d message;\n    toast.className \u003d \"toast show\";\n    setTimeout(() \u003d\u003e {\n      toast.className \u003d toast.className.replace(\"show\", \"\");\n    }, duration);\n  }\n\n  function showStep(step) {\n    for (let i \u003d 1; i \u003c\u003d 3; i++) {\n      document.getElementById(`step${i}`).style.display \u003d i \u003d\u003d\u003d step ? \u0027block\u0027 : \u0027none\u0027;\n    }\n    document.getElementById(\"folder-status\").textContent \u003d \"\";\n    document.getElementById(\"generate-status\").textContent \u003d \"\";\n  }\n\n  const yearSelect \u003d document.getElementById(\"year\");\n  const baseYear \u003d 2024;\n  for (let i \u003d 0; i \u003c 10; i++) {\n    const y1 \u003d baseYear + i;\n    const y2 \u003d y1 + 1;\n    const option \u003d document.createElement(\"option\");\n    option.value \u003d `${y1}/${y2}`;\n    option.textContent \u003d `${y1}/${y2}`;\n    yearSelect.appendChild(option);\n  }\n\n  function selectType(btn, value) {\n    document.getElementById(\"type\").value \u003d value;\n    document.getElementById(\"btn-agm\").classList.remove(\"custom-color\");\n    document.getElementById(\"btn-egm\").classList.remove(\"custom-color\");\n    btn.classList.add(\"custom-color\");\n  }\n\n  function checkFolder() {\n    const folderName \u003d document.getElementById(\"folder\").value.trim();\n    if (!folderName) return showToast(\"Please enter a folder name\");\n    document.getElementById(\"folder-status\").textContent \u003d \"Checking folder...\";\n    google.script.run.withSuccessHandler(function(exists) {\n      if (exists) {\n        showStep(2);\n      } else {\n        document.getElementById(\"folder-status\").textContent \u003d \"Folder not found. Please create it in your Drive and try again.\";\n        showToast(\"Folder not found.\");\n      }\n    }).checkFolderExists(folderName);\n  }\n\n  function confirmSubmission() {\n    const data \u003d {\n      roles: document.getElementById(\"roles\").value,\n      society: document.getElementById(\"society\").value,\n      type: document.getElementById(\"type\").value,\n      year: document.getElementById(\"year\").value,\n      folder: document.getElementById(\"folder\").value\n    };\n\n    if (!data.roles || !data.society || !data.type || !data.year || !data.folder) {\n      return showToast(\"Please fill in all fields and select a type.\");\n    }\n\n    const confirmed \u003d confirm(\"Are you sure you want to generate the forms?\");\n    if (confirmed) submitForm(data);\n  }\n\n  function submitForm(data) {\n    document.getElementById(\"generate-status\").textContent \u003d \"Generating forms...\";\n    google.script.run.withSuccessHandler(function(success) {\n      if (success) {\n        document.getElementById(\"result-img\").img \u003d \"https://drive.google.com/thumbnail?id\u003d1g-pQW6qmVFaljA559kDufB63jm_iVKV8\";\n        document.getElementById(\"result-msg\").textContent \u003d \"Forms created successfully!\";\n        showToast(\"✅ Forms created!\");\n        showStep(3);\n      } else {\n        document.getElementById(\"result-img\").img \u003d \"https://drive.google.com/thumbnail?id\u003d1sbCd_XoP7EuQlifGHoyjE8znuQfsyMmL\";\n        document.getElementById(\"result-msg\").textContent \u003d \"An error occurred. Please try again.\";\n        showToast(\"❌ Something went wrong.\");\n        showStep(3);\n      }\n    }).generateForms(data);\n  }\n\u003c/script\u003e\n\n\u003c/body\u003e\n\u003c/html\u003e\n"}]}